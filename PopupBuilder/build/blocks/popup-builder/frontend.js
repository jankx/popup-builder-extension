(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=function(e){const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length?t.pop().split(";").shift():null},o=function(e,t,o){let n=`${e}=${t}; path=/`;if(o){const e=new Date;e.setTime(e.getTime()+60*o*60*1e3),n+=`; expires=${e.toUTCString()}`}document.cookie=n},n=window.wp.hooks,i=(e,t)=>{let o=e.getAttribute("id");o=o.replace("popup-builder-","");const{entrAnimation:n,exitAnimation:i,animationDuration:r,type:p}=t||{},s=e.querySelector(".popup-builder-container");s.classList.remove(`${n}`),s.classList.add(`${i}`),s.classList.add("reverse"),setTimeout(()=>{["popup","full-screen"].includes(p)&&t?.preventScroll&&(window.parent.document.body.style.overflow=""),e.classList.remove("popup-builder-modal--open"),s.classList.remove(`${i}`),s.classList.remove("reverse"),window.frameElement&&window.frameElement.remove()},1e3*r)},r=window.wp.apiFetch;var p=e.n(r);const s=async(e,t)=>{let n=e.getAttribute("id");n=n.replace("popup-builder-","");const r=e.querySelector(".popup-builder-container"),s=e.querySelector(".popup-builder-close"),u=window.parent.window.getComputedStyle(e),{left:d,right:a,top:l,bottom:c}=u||{},{outsideClose:b,entrAnimation:w,animationDuration:m,type:v}=t||{},f=window.frameElement;let g="display:flex;position:fixed;z-index:9999;border:none;";f&&(f.style=g+"height:100%;width:100%;top:0;left:0;"),e.classList.add("popup-builder-modal--open"),["popup","full-screen"].includes(v)&&t?.preventScroll&&(window.parent.document.body.style.overflow="hidden");const y=e.getBoundingClientRect(),h=e=>"0px"===e?0:void 0;if(!["popup","full-screen"].includes(v)&&f){let e="100%",t=y.height+30+"px";"slide-in"===v&&(e="100vw",t="100vh",g+="pointer-events: none;",function(){function e(e){f.style.pointerEvents=e?"auto":"none"}f.addEventListener("mouseenter",()=>{e(!1)}),window.parent.window.addEventListener("message",t=>{switch(t.data){case"popupkit-enable-pointer":e(!0);break;case"popupkit-disable-pointer":e(!1)}}),window.parent.document.addEventListener("mousemove",t=>{const o=t.target.tagName.toUpperCase();e("BODY"===o||"DIV"===o)})}(),function(){const e=document.querySelector(".popup-builder-modal");e&&(e.addEventListener("mouseenter",function(){window.parent.postMessage("popupkit-enable-pointer","*")}),e.addEventListener("mouseleave",function(){window.parent.postMessage("popupkit-disable-pointer","*")}))}()),f.style=g+`height:${t};width:${e};bottom:${h(c)};left:${h(d)};right:${h(a)};top:${h(l)};`}w&&(r.classList.add(`${w}`),r.style.setProperty("--pbb-popup-animate-duration",`${m}s`),setTimeout(()=>{r.classList.remove(`${w}`)},1e3*m)),s&&s.addEventListener("click",()=>i(e,t)),b&&e.addEventListener("click",o=>{const n=e.querySelector(".popup-builder-content");n&&n.contains(o.target)||i(e,t)}),(s||b)&&window.parent.document.addEventListener("keydown",function(o){"Escape"===o.key&&i(e,t)}),location.search.includes("iframe=true")&&p()({path:"/pbb/v1/popup/logs",method:"POST",data:{postId:Number(n)}}).then(e=>{if("success"===e.status){const{logId:t,userDetails:n,location:i}=e.data;o("pbb_user_info",JSON.stringify(n),8760),sessionStorage.setItem("pbb_logs",t),o("pbb_location",JSON.stringify(i),8760)}})},u=e=>{const{popupID:r,popupAttributes:p}=(e=>{const t=JSON.parse(e.getAttribute("data-settings"));return{popupID:e.getAttribute("id").replace("popup-builder-",""),popupAttributes:t}})(e),{openTrigger:u,pageLoadDelay:d,scrolledToValue:a,userInactivityTime:l,scheduleDateTime:c,displayVisitor:b,adblockDetection:w}=p||{},m=()=>{"once-a-day"===b?.frequency?"true"!==t(`pbb_viewed_${r}`)&&(o(`pbb_viewed_${r}`,"true",24),s(e,p)):(0,n.doAction)("popup-builder.checkFrequency",e,r,p,t,o,s)},v=()=>{b?.convertionOff&&"true"===t(`pbb_conversion_${r}`)||("new"===b?.visitor?"true"!==t("pbb_new_visitor")&&"true"!==t("pbb_old_visitor")&&(o("pbb_new_visitor","true",24*b?.newDayCount),o("pbb_old_visitor","true",24*b?.returnDayCount),s(e,p)):"return"===b?.visitor?"true"!==t("pbb_old_visitor")?o("pbb_old_visitor","true",24*b?.returnDayCount):m():(m(),"true"!==t("pbb_old_visitor")&&o("pbb_old_visitor","true",24*b?.returnDayCount))),"true"===t(`pbb_conversion_${r}`)&&o(`pbb_conversion_${r}`,"true",8760),"page-scroll"===u&&window.parent.window.removeEventListener("scroll",f),"inactivity"===u&&window.parent.document.removeEventListener("mousemove",y),"page-exit"===u&&window.parent.document.removeEventListener("mouseout",_)},f=()=>{const e=window.parent.document.documentElement.scrollHeight-window.innerHeight;window.parent.window.scrollY/e*100>=a&&v()};let g;const y=()=>{clearTimeout(g),g=setTimeout(()=>{v()},1e3*l)};let h=!0;const _=e=>{e.clientY<=0&&h&&(v(),h=!1)},L=()=>{"page-load"===u?setTimeout(()=>{v()},1e3*d):(0,n.doAction)("popup-builder.checkOpenTrigger",e,p,_,f,y,s)},$=()=>{c?(0,n.doAction)("popup-builder.checkTimeAndShowPopup",e,p,L,i):L()};w&&"function"==typeof window.parent.adblockDetect?window.parent.adblockDetect(function(e){e&&$()}):$()};window.addEventListener("load",()=>{const e=document.querySelectorAll(".popup-builder-modal");if(e.length>0)for(const t of e)location.search.includes("iframe=true")&&u(t)})})();